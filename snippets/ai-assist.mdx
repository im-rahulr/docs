import { useState } from 'react';

export default function AIAssist() {
  const [isOpen, setIsOpen] = useState(false);

  const openWithPrompt = (provider) => {
    try {
      const pageUrl = typeof window !== 'undefined' ? window.location.href : '';
      const text = `Help me with this docs page: ${pageUrl}`;
      const encoded = encodeURIComponent(text);

      if (typeof navigator !== 'undefined' && navigator?.clipboard?.writeText) {
        navigator.clipboard.writeText(pageUrl).catch(() => {});
      }

      let target = '';
      if (provider === 'chatgpt') target = `https://chat.openai.com/?q=${encoded}`;
      if (provider === 'gemini') target = `https://gemini.google.com/app?hl=en&q=${encoded}`;

      if (target && typeof window !== 'undefined') {
        window.open(target, '_blank', 'noopener,noreferrer');
      }
    } catch {}
  };

  return (
    <div
      style={{
        position: 'fixed',
        right: '16px',
        top: '16px',
        zIndex: 2147483647,
        display: 'flex',
        flexDirection: 'column',
        alignItems: 'flex-end',
        gap: '8px',
        pointerEvents: 'none'
      }}
    >
      {isOpen && (
        <div
          style={{
            background: 'rgba(0,0,0,0.9)',
            color: '#fff',
            padding: '8px',
            borderRadius: '12px',
            display: 'flex',
            gap: '8px',
            boxShadow: '0 8px 24px rgba(0,0,0,0.25)',
            pointerEvents: 'auto'
          }}
        >
          <button onClick={() => openWithPrompt('chatgpt')} style={{ background: '#10A37F', color: '#fff', border: 'none', padding: '8px 12px', borderRadius: '10px', cursor: 'pointer', fontWeight: 600 }}>ChatGPT</button>
          <button onClick={() => openWithPrompt('gemini')} style={{ background: '#1A73E8', color: '#fff', border: 'none', padding: '8px 12px', borderRadius: '10px', cursor: 'pointer', fontWeight: 600 }}>Gemini</button>
        </div>
      )}

      <button
        onClick={() => setIsOpen((v) => !v)}
        style={{
          background: '#000000',
          color: '#fff',
          border: '1px solid rgba(255,255,255,0.12)',
          padding: '10px 14px',
          borderRadius: '999px',
          cursor: 'pointer',
          fontWeight: 600,
          display: 'flex',
          alignItems: 'center',
          gap: '8px',
          boxShadow: '0 6px 18px rgba(0,0,0,0.25)',
          pointerEvents: 'auto'
        }}
        aria-label="Ask AI"
      >
        <span style={{ filter: 'grayscale(1) brightness(1.2)' }}>âœ¨</span>
        Ask AI
      </button>
    </div>
  );
}


